general:

- Llevar cosas que sacamos del kyg a lib.rs y desde ctehexml
    - Nos falta:
        - windows:
            - Fshobst: empezar con 1.0 en vez de 0.0?
        - walls: En general, calcular U de elementos enterrados e interiores con espacios no habitables
- Detectar elementos que pertenecen a la envolvente a partir de espacios
    - son los elementos que pertenecen a espacios dentro de la envolvente pero
      que no comunican con otros espacios interiores a la envolvente
- Incluir construcciones en la exportación
    - Complica un poco más los tipos, ya que hay por resistencia y por conductividad
    - Exportar materiales para poder calcular U con capas. Para eso necesitamos biblioteca base en Rust para interpretar construcciones:
        - BDCatalogo.bdc.utf8 -> Convertir a datos Rust

- Añadir tests de tbl.rs (parse)
- ¿Convertir vectores de objetos de espacios, pisos, etc a vectores de nombres y hashmaps de objetos
  o convertir a https://docs.rs/crate/indexmap/?
    - Esto igual es mejor como una cache para hacer las consultas (una función que memoize la búsqueda o algo así)
- Migrar de failure a thiserror o anyhow: https://github.com/bytecodealliance/cranelift/pull/1188/files
- Usar referencias con hashes como IDs:
        #[derive(Hash)]
        struct Block {
            ...
        }

        fn get_id<T: Hash>(t: &T) -> String {
            let mut s = DefaultHasher::new();
            t.hash(&mut s);
            s.finish(); // u64
            format!("{:x}", s)
        }

ideas:
- hacer visualizador 3d (con 3djs).

envolventectedata:
    Llevar a env:
        - Volumen neto de espacios: data.space_volume(spacename)
        - ir viendo los cálculos que hacemos cómo se pueden llevar de BDL a types eliminando aspectos innecesarios
            wall -> data.wall_gross_area(wallname), data.wall_net_area(wallname), data.wall_azimuth(wallname)
            ...
        - Volumen interno a la envolvente térmica: volumen_et
        - K (igual devuelve estructura con datos intermedios por tipos, área de intercambio, etc)

BDL:
- Se podría eliminar la referencia entre muros y espacios, generando el polígono del muro a partir de su referencia al polígono del espacios
    - así eliminamos referencias a vértices de polígonos y también location
- Quitar de los elementos aquellas cosas que necesitan consultas globales (con acceso a bdldata)
- Comprobar qué se cambia en las plantas o en el edificio cuando se indica una cota base distinta a la 0.0 (ver si se pone la Z de la planta P01 distinta a "")
- Convertir definición de muros de polygon o location a (X, Y, Z, WIDTH, HEIGHT, AZIMUTH)
- Implementar espacios (y plantas) con multiplicadores (mediciones)
- Seguir eliminando bloques genéricos convirtiendo a estructuras los elementos BDL:
    - metadatos
    - horarios
    - condiciones operacionales
    - consignas
- Implementar cálculo de U para los distintos elementos y así no usar kyg
  (O al menos calcular con suma de las resistencias superficiales)

EnvolventeCTE:
- Eliminar uso de data.autil y usar data.a_util_ref()
- Calculador de elementos para obtener % de afección de U según intercalarios y cajón de persiana a partir de expresiones en DA DB-HE1 (p.13)
